---
layout: post
title: Java, convertir des wav en mp3
---
Je maintiens une IHM d'administration dans laquelle un petit player flash permet d'écouter des fichiers wav.<br /><br />Le passage au player html5 a été laborieux.<br /><br />Le player devait s'afficher dans une popup (on utilisait auparavant qtip mais le passage à html5 faisait planter le rendu aléatoirement) et un problème d'affichage du temps total du morceau était présent de temps à autre (cf solution dans billet précédent).<br /><br />Une fois la popup affichée et le problème de temps résolu, je me suis heurté à un autre problème de taille... <br /><br />En effet, IE11 (un des navigateurs à supporter) ne lit pas les fichiers wav !!!<br /><br />J'ai donc cherché à convertir les fichiers wav en mp3.<br /><br />La plupart des solutions sont à base de ffmepg encapsulé (comme JAVE) mais je n'ai pas réussi à les intégrer pour les faire fonctionner dans Tomcat.<br />Cela était certainement dû au Security Manager...<br /><br />Puis par chance, j'ai trouvé un convertisseur 100% java : Jump3r<br /><br />La bibliothèque est disponible sur le repository maven (<a href="https://mvnrepository.com/artifact/de.sciss/jump3r/1.0.4">https://mvnrepository.com/artifact/de.sciss/jump3r/1.0.4</a>) et les sources sur <a href="https://github.com/Sciss/jump3r">https://github.com/Sciss/jump3r</a><br /><br />L'utilisation est simple pour convertir un fichier wav en mp3. Voici ci-dessous un exemple :<br /><br /><script src="https://pastebin.com/embed_js/J0pPPQpc"></script><br /><br />Dans celui-ci, la fonction <i>main</i> a été <i>inlinée</i> pour permettre d'attraper/relancer une éventuelle <i>IOException</i>.<br /><br />Jump3r m'a sauvé la vie : il a permis de modifier la servlet qui délivrait le wav pour lui faire délivrer un mp3 compatible avec tous les players HTML 5 des navigateurs.<br /><br />Liens utiles<br /><a href="http://textopia.org/androidsoundformats.html">http://textopia.org/androidsoundformats.html</a><br /><a href="http://dinbror.dk/blog/how-to-preload-entire-html5-video-before-play-solved/">http://dinbror.dk/blog/how-to-preload-entire-html5-video-before-play-solved/</a>
