---
layout: post
title: "mysql, initialiser une table avec d'autres tables"
date: "2012-07-20 16:58:00"
---
Dans le cadre d'un projet, je dois initialiser une table à partir des valeurs d'autres tables.  La clé primaire de la nouvelle table peut être présente plusieurs fois dans chacune des tables "référentes" et les données associées différentes.  La table a initialisée gardera la première valeur non vide reçue.  Voici le code mysql :  <code><pre><br />sql&gt; insert into enveloppesTTS (enveloppe, tts) <br />select DIFFUSE_QUESTION, DIFFUSE_QUESTION_TS from acquisitionCorpus <br />where DIFFUSE_QUESTION not in ('', '-') <br />on duplicate key <br />update enveloppesTTS.tts=if(enveloppesTTS.tts&lt;&gt;'',enveloppesTTS.tts,values(tts));<br />sql&gt; insert into enveloppesTTS (enveloppe, tts) <br />select DIFFUSE_QUESTION, DIFFUSE_QUESTION_TS from traitementsSpecifiques <br />where DIFFUSE_QUESTION not in ('', '-') <br />on duplicate key <br />update enveloppesTTS.tts=if(enveloppesTTS.tts&lt;&gt;'',enveloppesTTS.tts,values(tts));<br />sql&gt; insert into enveloppesTTS (enveloppe, tts) <br />select DIFFUSE, DIFFUSE_TS from traitementsSpecifiques <br />where DIFFUSE not in ('', '-') <br />on duplicate key <br />update enveloppesTTS.tts=if(enveloppesTTS.tts&lt;&gt;'',enveloppesTTS.tts,values(tts));<br /><br /></pre></code> La méthode values permet de récupérer la nouvelle valeur du champ qui doit être inséré.  Bref, une syntaxe sympa qui peut faire $économiser$ du temps !
